<div class="main-content">
  <div class="admin-dashboard">
    <!-- Header Premium -->
    <div class="dashboard-header">
      <div class="header-content">
        <div class="header-title">
          <div class="title-icon">üßæ</div>
          <div>
            <h1>QU·∫¢N L√ù H√ìA ƒê∆†N</h1>
            <p>Theo d√µi v√† qu·∫£n l√Ω h√≥a ƒë∆°n karaoke</p>
          </div>
        </div>
        <div class="header-actions">
          <button class="btn-primary" onclick="openHoaDonModal()">
            <i class="fas fa-plus"></i>
            <span>T·∫°o h√≥a ƒë∆°n</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Search and Filter Bar -->
    <div class="search-filter-bar">
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm h√≥a ƒë∆°n..." onkeyup="filterHoaDon()">
        <button class="search-btn" onclick="filterHoaDon()">T√¨m ki·∫øm</button>
      </div>
      <div class="filter-controls">
        <select class="filter-select" id="statusFilter" onchange="filterHoaDon()">
          <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
          <option value="Ch∆∞a thanh to√°n">Ch∆∞a thanh to√°n</option>
          <option value="ƒê√£ thanh to√°n">ƒê√£ thanh to√°n</option>
          <option value="ƒê√£ h·ªßy">ƒê√£ h·ªßy</option>
        </select>
        <input type="date" class="filter-select" id="dateFromFilter" onchange="filterHoaDon()" placeholder="T·ª´ ng√†y">
        <input type="date" class="filter-select" id="dateToFilter" onchange="filterHoaDon()" placeholder="ƒê·∫øn ng√†y">
        <select class="filter-select" id="sortFilter" onchange="filterHoaDon()">
          <option value="newest">M·ªõi nh·∫•t</option>
          <option value="oldest">C≈© nh·∫•t</option>
          <option value="highest">Cao nh·∫•t</option>
          <option value="lowest">Th·∫•p nh·∫•t</option>
        </select>
        <button class="clear-filters" onclick="clearFilters()">
          <i class="fas fa-times"></i>
          X√≥a l·ªçc
        </button>
      </div>
    </div>

    <!-- Stats Overview -->
    <div class="stats-overview">
      <div class="stat-card">
        <div class="stat-icon total">
          <i class="fas fa-receipt"></i>
        </div>
        <div class="stat-info">
          <h3 id="statTotal">0</h3>
          <p>T·ªïng h√≥a ƒë∆°n</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon active">
          <i class="fas fa-money-bill-wave"></i>
        </div>
        <div class="stat-info">
          <h3 id="statRevenue">0</h3>
          <p>Doanh thu h√¥m nay</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon reception">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-info">
          <h3 id="statPending">0</h3>
          <p>Ch·ªù thanh to√°n</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon service">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-info">
          <h3 id="statPaid">0</h3>
          <p>ƒê√£ thanh to√°n</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon technical">
          <i class="fas fa-times-circle"></i>
        </div>
        <div class="stat-info">
          <h3 id="statCancelled">0</h3>
          <p>ƒê√£ h·ªßy</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon manager">
          <i class="fas fa-calendar-day"></i>
        </div>
        <div class="stat-info">
          <h3 id="statToday">0</h3>
          <p>H√≥a ƒë∆°n h√¥m nay</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon security">
          <i class="fas fa-calendar-week"></i>
        </div>
        <div class="stat-info">
          <h3 id="statWeek">0</h3>
          <p>Tu·∫ßn n√†y</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon fulltime">
          <i class="fas fa-calendar-month"></i>
        </div>
        <div class="stat-info">
          <h3 id="statMonth">0</h3>
          <p>Th√°ng n√†y</p>
        </div>
      </div>
    </div>

    <!-- HoaDon Grid -->
    <div class="employees-grid" id="hoaDonGrid">
      {{#each hoadons}}
      <div class="employee-card" 
           data-id="{{this._id}}" 
           data-mahd="{{this.MaHoaDon}}"
           data-madp="{{this.MaDatPhong}}"
           data-tongtien="{{this.TongTien}}" 
           data-status="{{this.TrangThai}}" 
           data-date="{{formatDate this.createdAt}}">
        <div class="employee-image">
          <div class="employee-avatar-placeholder bill">
            <i class="fas fa-receipt"></i>
          </div>
          <div class="employee-overlay">
            <div class="employee-actions">
              <button class="btn-edit" onclick="editHoaDon('{{this.MaHoaDon}}')">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-delete" onclick="deleteHoaDon('{{this._id}}', '{{this.MaHoaDon}}')">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>
          <div class="employee-badge {{this.TrangThai}}">
            {{this.TrangThai}}
          </div>
          <div class="employee-status {{#if (eq this.TrangThai 'ƒê√£ thanh to√°n')}}active{{else if (eq this.TrangThai 'Ch∆∞a thanh to√°n')}}onleave{{else}}inactive{{/if}}">
            {{formatCurrency this.TongTien}}
          </div>
        </div>

        <div class="employee-content">
          <h3 class="employee-name">{{this.MaHoaDon}}</h3>
          <p class="employee-code">ƒê·∫∑t ph√≤ng: {{this.MaDatPhong}}</p>

          <div class="employee-details">
            <div class="detail-item">
              <i class="fas fa-calendar-alt"></i>
              <span>{{formatDate this.createdAt}}</span>
            </div>
            <div class="detail-item">
              <i class="fas fa-money-bill-wave"></i>
              <span>{{formatCurrency this.TongTien}}</span>
            </div>
            <div class="detail-item">
              <i class="fas fa-user"></i>
              <span>KH: {{this.MaKH}}</span>
            </div>
            <div class="detail-item">
              <i class="fas fa-door-open"></i>
              <span>Ph√≤ng: {{this.MaPhong}}</span>
            </div>
            {{#if this.ThoiGianBatDau}}
            <div class="detail-item">
              <i class="fas fa-play-circle"></i>
              <span>B·∫Øt ƒë·∫ßu: {{formatTime this.ThoiGianBatDau}}</span>
            </div>
            {{/if}}
            {{#if this.ThoiGianKetThuc}}
            <div class="detail-item">
              <i class="fas fa-stop-circle"></i>
              <span>K·∫øt th√∫c: {{formatTime this.ThoiGianKetThuc}}</span>
            </div>
            {{/if}}
          </div>

          <!-- Chi ti·∫øt d·ªãch v·ª• -->
          <div class="service-breakdown">
            <h4>D·ªãch v·ª• s·ª≠ d·ª•ng:</h4>
            {{#each this.ChiTietHoaDon}}
            <div class="service-item">
              <span class="service-name">{{this.TenHang}}</span>
              <span class="service-quantity">x{{this.SoLuong}}</span>
              <span class="service-price">{{formatCurrency this.ThanhTien}}</span>
            </div>
            {{/each}}
          </div>

          <!-- FOOTER V·ªöI 2 N√öT -->
          <div class="employee-footer">
            <button class="btn-detail" onclick="viewHoaDonDetail('{{this.MaHoaDon}}')">
              <i class="fas fa-eye"></i>
              Xem chi ti·∫øt
            </button>
            {{#if (eq this.TrangThai "Ch∆∞a thanh to√°n")}}
            <button class="btn-pay" onclick="thanhToanHoaDon('{{this.MaHoaDon}}')">
              <i class="fas fa-credit-card"></i>
              Thanh to√°n
            </button>
            {{else}}
            <button class="btn-print" onclick="printHoaDon('{{this.MaHoaDon}}')">
              <i class="fas fa-print"></i>
              In h√≥a ƒë∆°n
            </button>
            {{/if}}
          </div>
        </div>
      </div>
      {{/each}}
    </div>

    <!-- Empty State -->
    <div class="empty-state" id="emptyState" style="{{#if hoadons.length}}display: none;{{else}}display: block;{{/if}}">
      <div class="empty-icon">üßæ</div>
      <h3>Kh√¥ng t√¨m th·∫•y h√≥a ƒë∆°n</h3>
      <p>Th·ª≠ thay ƒë·ªïi b·ªô l·ªçc ho·∫∑c t·∫°o h√≥a ƒë∆°n m·ªõi</p>
      <button class="btn-primary" onclick="openHoaDonModal()">
        <i class="fas fa-plus"></i>
        T·∫°o h√≥a ƒë∆°n ƒë·∫ßu ti√™n
      </button>
    </div>
  </div>

  <!-- HoaDon Modal -->
  <div class="modal-overlay" id="hoaDonModal" style="display: none;">
    <div class="modal-container large">
      <div class="modal-header">
        <h2 id="modalTitle">T·∫°o h√≥a ƒë∆°n m·ªõi</h2>
        <button class="modal-close" onclick="closeHoaDonModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="modal-body">
        <form id="hoaDonForm" onsubmit="saveHoaDon(event)">
          <input type="hidden" id="hoaDonId">
          <input type="hidden" id="hoaDonMaHD">

          <div class="form-grid">
            <div class="form-group">
              <label for="datPhongSelect">ƒê·∫∑t ph√≤ng *</label>
              <select id="datPhongSelect" required onchange="loadDatPhongInfo()">
                <option value="">Ch·ªçn ƒë·∫∑t ph√≤ng</option>
                {{#each datphongs}}
                <option value="{{this.MaDatPhong}}" data-makh="{{this.MaKH}}" data-maphong="{{this.MaPhong}}">
                  {{this.MaDatPhong}} - Ph√≤ng {{this.MaPhong}}
                </option>
                {{/each}}
              </select>
            </div>

            <div class="form-group">
              <label for="maKH">M√£ kh√°ch h√†ng</label>
              <input type="text" id="maKH" readonly>
            </div>

            <div class="form-group">
              <label for="maPhong">M√£ ph√≤ng</label>
              <input type="text" id="maPhong" readonly>
            </div>

            <div class="form-group">
              <label for="thoiGianBatDau">Th·ªùi gian b·∫Øt ƒë·∫ßu</label>
              <input type="datetime-local" id="thoiGianBatDau" readonly>
            </div>

            <div class="form-group">
              <label for="thoiGianKetThuc">Th·ªùi gian k·∫øt th√∫c</label>
              <input type="datetime-local" id="thoiGianKetThuc">
            </div>

            <div class="form-group">
              <label for="hoaDonStatus">Tr·∫°ng th√°i *</label>
              <select id="hoaDonStatus" required>
                <option value="Ch∆∞a thanh to√°n">Ch∆∞a thanh to√°n</option>
                <option value="ƒê√£ thanh to√°n">ƒê√£ thanh to√°n</option>
                <option value="ƒê√£ h·ªßy">ƒê√£ h·ªßy</option>
              </select>
            </div>
          </div>

          <!-- Danh s√°ch d·ªãch v·ª• -->
          <div class="services-section">
            <h3>D·ªãch v·ª• s·ª≠ d·ª•ng</h3>
            <div class="service-controls">
              <select id="matHangSelect">
                <option value="">Ch·ªçn m·∫∑t h√†ng</option>
                {{#each mathangs}}
                <option value="{{this.MaHang}}" data-dongia="{{this.DonGia}}" data-dvt="{{this.DonViTinh}}" data-tenhang="{{this.TenHang}}" data-loaidichvu="{{this.LoaiDichVu}}">
                  {{this.TenHang}} - {{formatCurrency this.DonGia}}/{{this.DonViTinh}}
                </option>
                {{/each}}
              </select>
              <input type="number" id="soLuong" placeholder="S·ªë l∆∞·ª£ng" min="1" value="1">
              <button type="button" class="btn-secondary" onclick="addService()">
                <i class="fas fa-plus"></i> Th√™m
              </button>
            </div>

            <div class="services-list" id="servicesList">
              <!-- Danh s√°ch d·ªãch v·ª• s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
            </div>
          </div>

          <!-- T·ªïng ti·ªÅn -->
          <div class="total-section">
            <div class="total-row">
              <span>Ti·ªÅn ph√≤ng:</span>
              <span id="tienPhong">0</span>
            </div>
            <div class="total-row">
              <span>Ti·ªÅn d·ªãch v·ª•:</span>
              <span id="tienDichVu">0</span>
            </div>
            <div class="total-row grand-total">
              <span><strong>T·ªïng c·ªông:</strong></span>
              <span id="tongTien"><strong>0</strong></span>
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn-secondary" type="button" onclick="closeHoaDonModal()">H·ªßy</button>
        <button class="btn-primary" type="submit" form="hoaDonForm">L∆∞u h√≥a ƒë∆°n</button>
      </div>
    </div>
  </div>

  <!-- Chi ti·∫øt h√≥a ƒë∆°n Modal -->
  <div class="modal-overlay" id="detailModal" style="display: none;">
  <div class="modal-container invoice-modal">
    <!-- HEADER M·ªöI - ƒê√É ƒê∆Ø·ª¢C S·∫ÆP X·∫æP L·∫†I -->
    <div class="modal-header invoice-company-header">
      <!-- H√†ng 1: Logo c√¥ng ty v√† n√∫t h√†nh ƒë·ªông -->
      <div class="header-top-row">
        <div class="company-logo">
          <div class="logo-placeholder">
            <i class="fas fa-microphone-alt"></i>
          </div>
          <div class="company-info">
            <h1>KARAOKE NICE</h1>
            <p>123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP.HCM ‚Ä¢ 0123 456 789</p>
          </div>
        </div>
        <div class="header-actions" id="headerActions">
          <!-- N√∫t h√†nh ƒë·ªông s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t b·∫±ng JS -->
        </div>
      </div>
      
      <!-- H√†ng 2: Ti√™u ƒë·ªÅ -->
      <div class="header-title-row">
        <h2>CHI TI·∫æT H√ìA ƒê∆†N</h2>
      </div>
      
      <!-- H√†ng 3: Th√¥ng tin h√≥a ƒë∆°n -->
      <div class="header-meta-row">
        <div class="meta-item">
          <span class="label">Ng√†y xu·∫•t:</span>
          <span class="value" id="modal-invoice-date"></span>
        </div>
        <div class="meta-item">
          <span class="label">M√£ h√≥a ƒë∆°n:</span>
          <span class="value" id="modal-invoice-number"></span>
        </div>
        <div class="meta-item">
          <span class="label">Tr·∫°ng th√°i:</span>
          <span class="value status-badge" id="modal-invoice-status"></span>
        </div>
      </div>
    </div>
    
    <div class="modal-body" id="detailContent">
      <!-- N·ªôi dung chi ti·∫øt s·∫Ω ƒë∆∞·ª£c ƒëi·ªÅn b·∫±ng JS -->
    </div>
  </div>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  // ===== CONFIGURATION & STATE =====
  let allHoaDons = [];
  let filteredHoaDons = [];
  let selectedServices = [];
  let currentRoomPrice = 0;
  let nextCTHDId = 1;

  // ===== STATISTICS CALCULATION =====
  function calculateStatistics() {
    const hoaDons = allHoaDons;
    
    const totalHoaDons = hoaDons.length;
    const today = new Date().toDateString();
    const todayRevenue = hoaDons
      .filter(hd => new Date(hd.getAttribute('data-date')).toDateString() === today && 
                    hd.getAttribute('data-status') === 'ƒê√£ thanh to√°n')
      .reduce((sum, hd) => sum + parseFloat(hd.getAttribute('data-tongtien')), 0);
    
    const countPending = hoaDons.filter(hd => hd.getAttribute('data-status') === 'Ch∆∞a thanh to√°n').length;
    const countPaid = hoaDons.filter(hd => hd.getAttribute('data-status') === 'ƒê√£ thanh to√°n').length;
    const countCancelled = hoaDons.filter(hd => hd.getAttribute('data-status') === 'ƒê√£ h·ªßy').length;
    const countToday = hoaDons.filter(hd => 
      new Date(hd.getAttribute('data-date')).toDateString() === today
    ).length;

    updateStatCard('#statTotal', totalHoaDons);
    updateStatCard('#statRevenue', formatCurrency(todayRevenue));
    updateStatCard('#statPending', countPending);
    updateStatCard('#statPaid', countPaid);
    updateStatCard('#statCancelled', countCancelled);
    updateStatCard('#statToday', countToday);
    updateStatCard('#statWeek', Math.floor(countToday * 1.5)); // Gi·∫£ l·∫≠p
    updateStatCard('#statMonth', Math.floor(countToday * 6)); // Gi·∫£ l·∫≠p
  }

  function updateStatCard(selector, value) {
    const element = document.querySelector(selector);
    if (element) {
      element.textContent = value;
    }
  }

  // ===== FORMAT FUNCTIONS =====
  function formatCurrency(amount) {
    if (typeof amount === 'string') {
      amount = parseFloat(amount) || 0;
    }
    return new Intl.NumberFormat('vi-VN', {
      style: 'currency',
      currency: 'VND'
    }).format(amount);
  }

  function formatDate(dateString) {
    if (!dateString) return 'N/A';
    const date = new Date(dateString);
    return date.toLocaleDateString('vi-VN');
  }

  function formatTime(dateString) {
    if (!dateString) return 'N/A';
    const date = new Date(dateString);
    return date.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' });
  }

  // ===== HOA DON MANAGEMENT =====
  function openHoaDonModal(hoaDonData = null) {
    document.getElementById('modalTitle').textContent = hoaDonData ? 'Ch·ªânh s·ª≠a h√≥a ƒë∆°n' : 'T·∫°o h√≥a ƒë∆°n m·ªõi';
    document.getElementById('hoaDonModal').style.display = 'flex';
    document.body.style.overflow = 'hidden';

    if (hoaDonData) {
      // ƒêi·ªÅn th√¥ng tin h√≥a ƒë∆°n
      document.getElementById('hoaDonId').value = hoaDonData._id || '';
      document.getElementById('hoaDonMaHD').value = hoaDonData.MaHoaDon || '';
      document.getElementById('datPhongSelect').value = hoaDonData.MaDatPhong || '';
      document.getElementById('hoaDonStatus').value = hoaDonData.TrangThai || 'Ch∆∞a thanh to√°n';
      
      // Load th√¥ng tin ƒë·∫∑t ph√≤ng
      loadDatPhongInfo();
      
      // Load d·ªãch v·ª•
      selectedServices = hoaDonData.ChiTietHoaDon || [];
      renderServicesList();
      calculateTotal();
    } else {
      resetHoaDonForm();
    }
  }

  function closeHoaDonModal() {
    document.getElementById('hoaDonModal').style.display = 'none';
    document.body.style.overflow = 'auto';
  }

  function resetHoaDonForm() {
    document.getElementById('hoaDonForm').reset();
    document.getElementById('hoaDonId').value = '';
    document.getElementById('hoaDonMaHD').value = '';
    document.getElementById('hoaDonStatus').value = 'Ch∆∞a thanh to√°n';
    selectedServices = [];
    renderServicesList();
    calculateTotal();
  }

  function loadDatPhongInfo() {
    const selectedOption = document.querySelector('#datPhongSelect option:checked');
    if (selectedOption && selectedOption.value) {
      document.getElementById('maKH').value = selectedOption.getAttribute('data-makh') || '';
      document.getElementById('maPhong').value = selectedOption.getAttribute('data-maphong') || '';
      
      // Load th√¥ng tin th·ªùi gian t·ª´ API
      fetch(`/api/datphong/${selectedOption.value}`)
        .then(response => response.json())
        .then(datPhong => {
          document.getElementById('thoiGianBatDau').value = formatDateTimeLocal(datPhong.ThoiGianBatDau);
          document.getElementById('thoiGianKetThuc').value = formatDateTimeLocal(datPhong.ThoiGianKetThuc);
          
          // T√≠nh ti·ªÅn ph√≤ng
          calculateRoomPrice();
        })
        .catch(error => {
          console.error('L·ªói khi l·∫•y th√¥ng tin ƒë·∫∑t ph√≤ng:', error);
        });
    }
  }

  function formatDateTimeLocal(dateString) {
    if (!dateString) return '';
    const date = new Date(dateString);
    return date.toISOString().slice(0, 16);
  }

  function calculateRoomPrice() {
    // Gi·∫£ l·∫≠p t√≠nh ti·ªÅn ph√≤ng d·ª±a tr√™n th·ªùi gian
    const start = new Date(document.getElementById('thoiGianBatDau').value);
    const end = new Date(document.getElementById('thoiGianKetThuc').value);
    
    if (start && end) {
      const hours = (end - start) / (1000 * 60 * 60);
      currentRoomPrice = hours * 100000; // 100k/gi·ªù
      document.getElementById('tienPhong').textContent = formatCurrency(currentRoomPrice);
      calculateTotal();
    }
  }

  function addService() {
    const matHangSelect = document.getElementById('matHangSelect');
    const soLuong = document.getElementById('soLuong');
    
    if (!matHangSelect.value || !soLuong.value || soLuong.value < 1) {
      showError('Vui l√≤ng ch·ªçn m·∫∑t h√†ng v√† s·ªë l∆∞·ª£ng');
      return;
    }

    const selectedOption = matHangSelect.options[matHangSelect.selectedIndex];
    const service = {
      MaCTHD: `CTHD${nextCTHDId++}`,
      MaHang: matHangSelect.value,
      TenHang: selectedOption.getAttribute('data-tenhang'),
      SoLuong: parseInt(soLuong.value),
      DonGia: parseFloat(selectedOption.getAttribute('data-dongia')),
      ThanhTien: parseInt(soLuong.value) * parseFloat(selectedOption.getAttribute('data-dongia')),
      LoaiDichVu: selectedOption.getAttribute('data-loaidichvu')
    };

    selectedServices.push(service);
    renderServicesList();
    calculateTotal();
    
    // Reset form
    matHangSelect.value = '';
    soLuong.value = 1;
  }

  function removeService(index) {
    selectedServices.splice(index, 1);
    renderServicesList();
    calculateTotal();
  }

  function renderServicesList() {
    const servicesList = document.getElementById('servicesList');
    servicesList.innerHTML = '';

    selectedServices.forEach((service, index) => {
      const serviceElement = document.createElement('div');
      serviceElement.className = 'service-item-row';
      serviceElement.innerHTML = `
        <div class="service-info">
          <span class="service-name">${service.TenHang}</span>
          <span class="service-details">${service.SoLuong} x ${formatCurrency(service.DonGia)} (${service.LoaiDichVu})</span>
        </div>
        <div class="service-actions">
          <span class="service-total">${formatCurrency(service.ThanhTien)}</span>
          <button type="button" class="btn-delete" onclick="removeService(${index})">
            <i class="fas fa-times"></i>
          </button>
        </div>
      `;
      servicesList.appendChild(serviceElement);
    });
  }

  function calculateTotal() {
    const serviceTotal = selectedServices.reduce((sum, service) => sum + service.ThanhTien, 0);
    const total = currentRoomPrice + serviceTotal;

    document.getElementById('tienDichVu').textContent = formatCurrency(serviceTotal);
    document.getElementById('tongTien').textContent = formatCurrency(total);
  }

  async function saveHoaDon(event) {
    event.preventDefault();

    const hoaDonId = document.getElementById('hoaDonId').value;
    const isEdit = !!hoaDonId;

    const formData = {
      MaDatPhong: document.getElementById('datPhongSelect').value,
      TrangThai: document.getElementById('hoaDonStatus').value,
      TongTien: parseFloat(document.getElementById('tongTien').textContent.replace(/[^\d]/g, '')),
      ChiTietHoaDon: selectedServices,
      ThoiGianKetThuc: document.getElementById('thoiGianKetThuc').value || new Date().toISOString()
    };

    // Validation
    if (!formData.MaDatPhong) {
      showError('Vui l√≤ng ch·ªçn ƒë·∫∑t ph√≤ng');
      return;
    }

    if (selectedServices.length === 0 && currentRoomPrice === 0) {
      showError('H√≥a ƒë∆°n ph·∫£i c√≥ √≠t nh·∫•t m·ªôt d·ªãch v·ª• ho·∫∑c ti·ªÅn ph√≤ng');
      return;
    }

    const url = isEdit ? `/api/hoadon/${document.getElementById('hoaDonMaHD').value}` : '/api/hoadon';
    const method = isEdit ? 'PUT' : 'POST';

    try {
      Swal.fire({
        title: 'ƒêang l∆∞u h√≥a ƒë∆°n...',
        text: 'Vui l√≤ng ch·ªù trong gi√¢y l√°t',
        allowOutsideClick: false,
        didOpen: () => Swal.showLoading()
      });

      const response = await fetch(url, {
        method: method,
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      });

      const result = await response.json();
      if (!response.ok) throw new Error(result.error || 'L·ªói server');

      Swal.fire({
        icon: 'success',
        title: 'Th√†nh c√¥ng!',
        text: result.message || `H√≥a ƒë∆°n ƒë√£ ƒë∆∞·ª£c ${isEdit ? 'c·∫≠p nh·∫≠t' : 't·∫°o'} th√†nh c√¥ng!`,
        timer: 1500,
        showConfirmButton: false
      });

      setTimeout(() => {
        location.reload();
      }, 1500);

    } catch (error) {
      console.error('‚ùå L·ªói khi l∆∞u h√≥a ƒë∆°n:', error);
      Swal.fire({
        icon: 'error',
        title: 'L·ªói!',
        text: error.message || 'Kh√¥ng th·ªÉ l∆∞u h√≥a ƒë∆°n',
        confirmButtonColor: '#667eea'
      });
    }
  }

  async function thanhToanHoaDon(maHoaDon) {
    try {
      const response = await fetch(`/api/hoadon/${maHoaDon}/thanhtoan`, {
        method: 'PUT'
      });

      if (response.ok) {
        Swal.fire({
          icon: 'success',
          title: 'Th√†nh c√¥ng!',
          text: 'H√≥a ƒë∆°n ƒë√£ ƒë∆∞·ª£c thanh to√°n',
          timer: 1500,
          showConfirmButton: false
        });
        setTimeout(() => location.reload(), 1500);
      } else {
        throw new Error('L·ªói khi thanh to√°n');
      }
    } catch (error) {
      Swal.fire({
        icon: 'error',
        title: 'L·ªói!',
        text: 'Kh√¥ng th·ªÉ thanh to√°n h√≥a ƒë∆°n'
      });
    }
  }

  function printHoaDon(maHoaDon) {
    // M·ªü c·ª≠a s·ªï in ho·∫∑c t·∫£i PDF
    window.open(`/api/hoadon/${maHoaDon}/print`, '_blank');
  }

  async function viewHoaDonDetail(maHoaDon) {
    try {
      // Hi·ªÉn th·ªã loading
      const detailContent = document.getElementById('detailContent');
      detailContent.innerHTML = `
        <div class="loading-invoice">
          <div class="loading-spinner"></div>
          <p>ƒêang t·∫£i th√¥ng tin h√≥a ƒë∆°n...</p>
        </div>
      `;
      
      // C·∫≠p nh·∫≠t th√¥ng tin header tr∆∞·ªõc
      document.getElementById('modal-invoice-number').textContent = `HD${maHoaDon}`;
      
      document.getElementById('detailModal').style.display = 'flex';

      // L·∫•y th√¥ng tin h√≥a ƒë∆°n v√† chi ti·∫øt song song
      const [chiTietResponse, hoaDonResponse] = await Promise.all([
        fetch(`/api/chitiethoadon/${maHoaDon}`),
        fetch(`/api/hoadon/${maHoaDon}`)
      ]);

      if (!chiTietResponse.ok || !hoaDonResponse.ok) {
        throw new Error('Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu h√≥a ƒë∆°n');
      }

      const chiTietHoaDon = await chiTietResponse.json();
      const hoaDon = await hoaDonResponse.json();

      console.log('Chi ti·∫øt h√≥a ƒë∆°n:', chiTietHoaDon);
      console.log('Th√¥ng tin h√≥a ƒë∆°n:', hoaDon);

      // C·∫¨P NH·∫¨T HEADER V·ªöI TH√îNG TIN TH·ª∞C T·∫æ
      document.getElementById('modal-invoice-date').textContent = 
        `${formatDate(hoaDon.createdAt)} ${formatTime(hoaDon.createdAt)}`;
      
      const statusElement = document.getElementById('modal-invoice-status');
      statusElement.className = `invoice-status ${hoaDon.TrangThai === 'ƒê√£ thanh to√°n' ? 'paid' : 'pending'}`;
      statusElement.querySelector('.value').textContent = hoaDon.TrangThai;

      // T√≠nh t·ªïng ti·ªÅn d·ªãch v·ª•
      const tongTienDichVu = Array.isArray(chiTietHoaDon) 
        ? chiTietHoaDon.reduce((sum, item) => sum + (item.ThanhTien || 0), 0)
        : 0;

      // Render ph·∫ßn body c·ªßa h√≥a ƒë∆°n (kh√¥ng bao g·ªìm header n·ªØa)
      renderInvoiceBody(hoaDon, chiTietHoaDon, tongTienDichVu);

    } catch (error) {
      console.error('L·ªói khi t·∫£i chi ti·∫øt h√≥a ƒë∆°n:', error);
      detailContent.innerHTML = `
        <div class="error-state">
          <div class="error-icon">‚ùå</div>
          <h3>Kh√¥ng th·ªÉ t·∫£i h√≥a ƒë∆°n</h3>
          <p>${error.message || 'Vui l√≤ng th·ª≠ l·∫°i sau'}</p>
          <button class="btn-primary" onclick="viewHoaDonDetail('${maHoaDon}')">
            <i class="fas fa-redo"></i>
            Th·ª≠ l·∫°i
          </button>
        </div>
      `;
    }
  }

  // ===== RENDER PH·∫¶N BODY C·ª¶A H√ìA ƒê∆†N (KH√îNG BAO G·ªíM HEADER) =====
  async function viewHoaDonDetail(maHoaDon) {
    try {
      // Hi·ªÉn th·ªã loading
      const detailContent = document.getElementById('detailContent');
      detailContent.innerHTML = `
        <div class="loading-invoice">
          <div class="loading-spinner"></div>
          <p>ƒêang t·∫£i th√¥ng tin h√≥a ƒë∆°n...</p>
        </div>
      `;
      
      // C·∫≠p nh·∫≠t ng√†y xu·∫•t v·ªõi th·ªùi gian hi·ªán t·∫°i
      const now = new Date();
      document.getElementById('modal-invoice-date').textContent = 
        `${formatDate(now)} ${formatTime(now)}`;
      
      document.getElementById('detailModal').style.display = 'flex';

      // L·∫•y th√¥ng tin h√≥a ƒë∆°n v√† chi ti·∫øt song song
      const [chiTietResponse, hoaDonResponse] = await Promise.all([
        fetch(`/api/chitiethoadon/${maHoaDon}`),
        fetch(`/api/hoadon/${maHoaDon}`)
      ]);

      if (!chiTietResponse.ok || !hoaDonResponse.ok) {
        throw new Error('Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu h√≥a ƒë∆°n');
      }

      const chiTietHoaDon = await chiTietResponse.json();
      const hoaDon = await hoaDonResponse.json();

      console.log('Chi ti·∫øt h√≥a ƒë∆°n:', chiTietHoaDon);
      console.log('Th√¥ng tin h√≥a ƒë∆°n:', hoaDon);

      // C·∫¨P NH·∫¨T HEADER V·ªöI TH√îNG TIN T·ª™ API
      document.getElementById('modal-invoice-number').textContent = `${hoaDon.MaHoaDon}`;
      
      const statusElement = document.getElementById('modal-invoice-status');
      statusElement.textContent = hoaDon.TrangThai;
      statusElement.className = `value status-badge ${hoaDon.TrangThai === 'ƒê√£ thanh to√°n' ? 'paid' : hoaDon.TrangThai === 'Ch∆∞a thanh to√°n' ? 'pending' : 'cancelled'}`;

      // C·∫¨P NH·∫¨T N√öT H√ÄNH ƒê·ªòNG TRONG HEADER
      updateHeaderActions(maHoaDon, hoaDon.TrangThai);

      // T√≠nh t·ªïng ti·ªÅn d·ªãch v·ª•
      const tongTienDichVu = Array.isArray(chiTietHoaDon) 
        ? chiTietHoaDon.reduce((sum, item) => sum + (item.ThanhTien || 0), 0)
        : 0;

      // Render ph·∫ßn body c·ªßa h√≥a ƒë∆°n
      renderInvoiceBody(hoaDon, chiTietHoaDon, tongTienDichVu);

    } catch (error) {
      console.error('L·ªói khi t·∫£i chi ti·∫øt h√≥a ƒë∆°n:', error);
      detailContent.innerHTML = `
        <div class="error-state">
          <div class="error-icon">‚ùå</div>
          <h3>Kh√¥ng th·ªÉ t·∫£i h√≥a ƒë∆°n</h3>
          <p>${error.message || 'Vui l√≤ng th·ª≠ l·∫°i sau'}</p>
          <button class="btn-primary" onclick="viewHoaDonDetail('${maHoaDon}')">
            <i class="fas fa-redo"></i>
            Th·ª≠ l·∫°i
          </button>
        </div>
      `;
    }
  }

  // ===== C·∫¨P NH·∫¨T N√öT H√ÄNH ƒê·ªòNG TRONG HEADER =====
  function updateHeaderActions(maHoaDon, trangThai) {
    const headerActions = document.getElementById('headerActions');
    
    let actionButtons = `
      <button class="btn-print-invoice" onclick="printInvoice()">
        <i class="fas fa-print"></i>
        In h√≥a ƒë∆°n
      </button>
    `;
    
    if (trangThai === 'Ch∆∞a thanh to√°n') {
      actionButtons += `
        <button class="btn-pay-invoice" onclick="thanhToanHoaDon('${maHoaDon}')">
          <i class="fas fa-credit-card"></i>
          Thanh to√°n
        </button>
      `;
    } else {
      actionButtons += `
        <button class="btn-download-invoice" onclick="downloadInvoice()">
          <i class="fas fa-download"></i>
          T·∫£i PDF
        </button>
      `;
    }
    
    actionButtons += `
      <button class="modal-close" onclick="closeDetailModal()">
        <i class="fas fa-times"></i>
      </button>
    `;
    
    headerActions.innerHTML = actionButtons;
  }

  // ===== RENDER PH·∫¶N BODY C·ª¶A H√ìA ƒê∆†N =====
  function renderInvoiceBody(hoaDon, chiTietHoaDon, tongTienDichVu) {
    const detailContent = document.getElementById('detailContent');
    
    // T√≠nh c√°c th√†nh ph·∫ßn ti·ªÅn
    const tienPhong = (hoaDon.TongTien || 0) - tongTienDichVu;
    const vat = (hoaDon.TongTien || 0) * 0.1; // VAT 10%
    const tongThanhToan = (hoaDon.TongTien || 0) + vat;

    detailContent.innerHTML = `
      <div class="modern-invoice" id="printableInvoice">
        <!-- Th√¥ng tin kh√°ch h√†ng v√† ph√≤ng -->
        <div class="invoice-customer-info">
          <div class="info-section">
            <h3>Th√¥ng tin kh√°ch h√†ng</h3>
            <div class="info-grid">
              <div class="info-item">
                <span class="label">M√£ KH:</span>
                <span class="value">${hoaDon.MaKH || 'N/A'}</span>
              </div>
              <div class="info-item">
                <span class="label">ƒê·∫∑t ph√≤ng:</span>
                <span class="value">${hoaDon.MaDatPhong || 'N/A'}</span>
              </div>
            </div>
          </div>
          <div class="info-section">
            <h3>Th√¥ng tin ph√≤ng</h3>
            <div class="info-grid">
              <div class="info-item">
                <span class="label">Ph√≤ng:</span>
                <span class="value">${hoaDon.MaPhong || 'N/A'}</span>
              </div>
              <div class="info-item">
                <span class="label">Th·ªùi gian:</span>
                <span class="value">${formatTime(hoaDon.ThoiGianBatDau)} - ${formatTime(hoaDon.ThoiGianKetThuc)}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- B·∫£ng d·ªãch v·ª• -->
        <div class="invoice-services">
          <h3>Chi ti·∫øt d·ªãch v·ª• s·ª≠ d·ª•ng</h3>
          <div class="services-table">
            <div class="table-header">
              <div class="col-service">D·ªãch v·ª•</div>
              <div class="col-quantity">S·ªë l∆∞·ª£ng</div>
              <div class="col-price">ƒê∆°n gi√°</div>
              <div class="col-total">Th√†nh ti·ªÅn</div>
            </div>
            
            ${tienPhong >= 0 ? `
            <div class="table-row">
              <div class="col-service">
                <span class="service-name">Thu√™ ph√≤ng ${hoaDon.MaPhong}</span>
                <span class="service-desc">${formatTime(hoaDon.ThoiGianBatDau)} - ${formatTime(hoaDon.ThoiGianKetThuc)}</span>
              </div>
              <div class="col-quantity">1</div>
              <div class="col-price">${formatCurrency(tienPhong)}</div>
              <div class="col-total">${formatCurrency(tienPhong)}</div>
            </div>
            ` : ''}
            
            ${Array.isArray(chiTietHoaDon) && chiTietHoaDon.length > 0 
              ? chiTietHoaDon
                  .filter(item => item.LoaiDichVu !== "Thu√™ ph√≤ng")
                  .map(item => `
                    <div class="table-row">
                      <div class="col-service">
                        <span class="service-name">${item.TenHang || item.MaHang || 'N/A'}</span>
                        ${item.LoaiDichVu ? `<span class="service-desc">${item.LoaiDichVu}</span>` : ''}
                      </div>
                      <div class="col-quantity">${item.SoLuong}</div>
                      <div class="col-price">${formatCurrency(item.DonGia)}</div>
                      <div class="col-total">${formatCurrency(item.ThanhTien)}</div>
                    </div>
                  `).join('')
              : '<div class="table-row no-services"><div class="col-service">Kh√¥ng c√≥ d·ªãch v·ª• n√†o</div></div>'
            }
          </div>
        </div>

        <!-- T·ªïng k·∫øt h√≥a ƒë∆°n -->
        <div class="invoice-summary">
          <div class="summary-row">
            <span class="label">T·ªïng ti·ªÅn d·ªãch v·ª•:</span>
            <span class="value">${formatCurrency(hoaDon.TongTien || 0)}</span>
          </div>
          <div class="summary-row">
            <span class="label">VAT (10%):</span>
            <span class="value">${formatCurrency(vat)}</span>
          </div>
          <div class="summary-row total">
            <span class="label">T·ªîNG C·ªòNG:</span>
            <span class="value">${formatCurrency(tongThanhToan)}</span>
          </div>
        </div>

        <!-- Ph∆∞∆°ng th·ª©c thanh to√°n -->
        <div class="invoice-payment">
          <div class="payment-method">
            <h4>Ph∆∞∆°ng th·ª©c thanh to√°n</h4>
            <div class="method ${hoaDon.TrangThai === 'ƒê√£ thanh to√°n' ? 'paid' : 'cash'}">
              <i class="fas ${hoaDon.TrangThai === 'ƒê√£ thanh to√°n' ? 'fa-credit-card' : 'fa-money-bill-wave'}"></i>
              <span>${hoaDon.TrangThai === 'ƒê√£ thanh to√°n' ? 'Th·∫ª t√≠n d·ª•ng' : 'Ti·ªÅn m·∫∑t'}</span>
            </div>
          </div>
          <div class="payment-notes">
            <h4>Ghi ch√∫</h4>
            <p>C·∫£m ∆°n qu√Ω kh√°ch ƒë√£ s·ª≠ d·ª•ng d·ªãch v·ª• c·ªßa ch√∫ng t√¥i!</p>
            <p>H·∫πn g·∫∑p l·∫°i qu√Ω kh√°ch trong nh·ªØng l·∫ßn ti·∫øp theo.</p>
          </div>
        </div>

        <!-- Footer h√≥a ƒë∆°n -->
        <div class="invoice-footer">
          <div class="footer-signature">
            <div class="signature-line"></div>
            <p>Ch·ªØ k√Ω nh√¢n vi√™n</p>
          </div>
          <div class="footer-thanks">
            <p><strong>KARAOKE NICE</strong></p>
            <p>Hotline: 0123 456 789</p>
          </div>
        </div>
      </div>
    `;
  }

  // ===== C√ÅC H√ÄM KH√ÅC GI·ªÆ NGUY√äN =====
  function printInvoice() {
    const printableElement = document.getElementById('printableInvoice');
    if (!printableElement) return;

    const printWindow = window.open('', '_blank', 'width=800,height=600');
    
    printWindow.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>H√≥a ƒë∆°n ${document.getElementById('modal-invoice-number').textContent}</title>
          <style>
            ${getInvoiceStyles()}
            
            /* CSS ri√™ng cho in ·∫•n */
            @media print {
              body { margin: 0; padding: 20px; }
              .modern-invoice { 
                box-shadow: none; 
                border: 1px solid #ddd;
                padding: 20px;
              }
              .btn-print-invoice, .btn-download-invoice, .btn-pay-invoice, .modal-close { 
                display: none !important; 
              }
            }
          </style>
        </head>
        <body>
          ${printableElement.outerHTML}
          <script>
            window.onload = function() {
              window.print();
              setTimeout(() => window.close(), 500);
            };
          <\/script>
        </body>
      </html>
    `);
    
    printWindow.document.close();
  }

  function downloadInvoice() {
    Swal.fire({
      title: 'ƒêang t·∫£i PDF...',
      text: 'H√≥a ƒë∆°n ƒëang ƒë∆∞·ª£c xu·∫•t ra file PDF',
      allowOutsideClick: false,
      didOpen: () => Swal.showLoading()
    });

    setTimeout(() => {
      Swal.fire({
        icon: 'success',
        title: 'Th√†nh c√¥ng!',
        text: 'H√≥a ƒë∆°n ƒë√£ ƒë∆∞·ª£c t·∫£i xu·ªëng',
        timer: 1500,
        showConfirmButton: false
      });
    }, 2000);
  }

  function closeDetailModal() {
    document.getElementById('detailModal').style.display = 'none';
  }

  // ===== H√ÄM FORMAT DATE V√Ä TIME =====
  function formatDate(date) {
    if (!date) return 'N/A';
    const d = new Date(date);
    return d.toLocaleDateString('vi-VN');
  }

  function formatTime(date) {
    if (!date) return 'N/A';
    const d = new Date(date);
    return d.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' });
  }

  function formatCurrency(amount) {
    if (typeof amount === 'string') {
      amount = parseFloat(amount) || 0;
    }
    return new Intl.NumberFormat('vi-VN', {
      style: 'currency',
      currency: 'VND'
    }).format(amount);
  }
  // ===== FILTER & SEARCH =====
  function filterHoaDon() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const statusFilter = document.getElementById('statusFilter').value;
    const dateFrom = document.getElementById('dateFromFilter').value;
    const dateTo = document.getElementById('dateToFilter').value;
    const sortFilter = document.getElementById('sortFilter').value;

    filteredHoaDons = allHoaDons.filter(card => {
      const maHD = card.getAttribute('data-mahd').toLowerCase();
      const maDP = card.getAttribute('data-madp').toLowerCase();
      const status = card.getAttribute('data-status');
      const date = card.getAttribute('data-date');

      const matchesSearch = !searchTerm || 
        maHD.includes(searchTerm) || 
        maDP.includes(searchTerm);
      const matchesStatus = !statusFilter || status === statusFilter;
      const matchesDate = (!dateFrom || date >= dateFrom) && 
                         (!dateTo || date <= dateTo);

      const shouldShow = matchesSearch && matchesStatus && matchesDate;
      card.style.display = shouldShow ? 'block' : 'none';
      return shouldShow;
    });

    // Sort
    sortHoaDons(sortFilter);
    calculateFilteredStatistics();
    toggleEmptyState(filteredHoaDons.length === 0);
  }

  function sortHoaDons(sortType) {
    const container = document.getElementById('hoaDonGrid');
    const cards = Array.from(container.querySelectorAll('.employee-card'));

    cards.sort((a, b) => {
      switch (sortType) {
        case 'newest':
          return new Date(b.getAttribute('data-date')) - new Date(a.getAttribute('data-date'));
        case 'oldest':
          return new Date(a.getAttribute('data-date')) - new Date(b.getAttribute('data-date'));
        case 'highest':
          return parseFloat(b.getAttribute('data-tongtien')) - parseFloat(a.getAttribute('data-tongtien'));
        case 'lowest':
          return parseFloat(a.getAttribute('data-tongtien')) - parseFloat(b.getAttribute('data-tongtien'));
        default:
          return 0;
      }
    });

    cards.forEach(card => container.appendChild(card));
  }

  function clearFilters() {
    document.getElementById('searchInput').value = '';
    document.getElementById('statusFilter').value = '';
    document.getElementById('dateFromFilter').value = '';
    document.getElementById('dateToFilter').value = '';
    document.getElementById('sortFilter').value = 'newest';

    filterHoaDon();
  }

  function toggleEmptyState(show) {
    const emptyState = document.getElementById('emptyState');
    const grid = document.getElementById('hoaDonGrid');

    if (!emptyState || !grid) return;

    if (show) {
      grid.style.display = 'none';
      emptyState.style.display = 'block';
    } else {
      grid.style.display = 'grid';
      emptyState.style.display = 'none';
    }
  }

  // ===== UTILITY FUNCTIONS =====
  function showError(message) {
    Swal.fire({
      icon: 'warning',
      title: 'Thi·∫øu th√¥ng tin',
      text: message,
      confirmButtonColor: '#667eea'
    });
  }

  // ===== INITIALIZATION =====
  document.addEventListener('DOMContentLoaded', function () {
    allHoaDons = Array.from(document.querySelectorAll('.employee-card'));
    filteredHoaDons = [...allHoaDons];
    
    calculateStatistics();
    
    // Event listeners
    document.getElementById('thoiGianKetThuc').addEventListener('change', calculateRoomPrice);
  });
</script>

<style>
/* ===== RESET & VARIABLES ===== */
:root {
  --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --success-gradient: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
  --warning-gradient: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
  --danger-gradient: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
  --info-gradient: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
  --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.08);
  --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);
  --shadow-heavy: 0 12px 40px rgba(0, 0, 0, 0.15);
  --border-radius: 12px;
  --border-radius-lg: 16px;
  --border-radius-xl: 20px;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* ===== LAYOUT CH√çNH ===== */
.main-content {
  margin-left: 280px;
  transition: margin-left 0.3s ease;
  min-height: 100vh;
  background: var(--bg-gradient);
}

.admin-dashboard {
  padding: 24px;
  min-height: 100vh;
}

/* ===== HEADER DASHBOARD ===== */
.dashboard-header {
  background: var(--primary-gradient);
  border-radius: var(--border-radius-lg);
  padding: 28px;
  margin-bottom: 28px;
  box-shadow: var(--shadow-light);
  color: white;
  position: relative;
  overflow: hidden;
}

.header-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 20px;
  position: relative;
  z-index: 1;
}

.header-title {
  display: flex;
  align-items: center;
  gap: 20px;
}

.title-icon {
  font-size: 3rem;
  filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
}

.header-title h1 {
  margin: 0;
  font-size: 2rem;
  font-weight: 700;
}

.header-title p {
  margin: 8px 0 0 0;
  opacity: 0.9;
  font-size: 1.1rem;
}

/* ===== N√öT CHUNG ===== */
.btn-primary {
  background: var(--success-gradient);
  color: white;
  border: none;
  padding: 14px 24px;
  border-radius: var(--border-radius);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 600;
  font-size: 1rem;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(72, 187, 120, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(72, 187, 120, 0.4);
}

.btn-secondary {
  background: #f1f5f9;
  border: 2px solid #e2e8f0;
  color: #64748b;
  padding: 14px 24px;
  border-radius: var(--border-radius);
  cursor: pointer;
  display: flex;
  align-items: center;
  transition: all 0.3s ease;
  font-weight: 600;
}

.btn-secondary:hover {
  background: #e2e8f0;
  color: #475569;
}

/* ===== THANH T√åM KI·∫æM & B·ªò L·ªåC ===== */
.search-filter-bar {
  background: white;
  border-radius: var(--border-radius-lg);
  padding: 24px;
  margin-bottom: 28px;
  display: flex;
  gap: 24px;
  align-items: center;
  flex-wrap: wrap;
  box-shadow: var(--shadow-light);
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.search-box {
  display: flex;
  align-items: center;
  background: #f8fafc;
  border-radius: var(--border-radius);
  padding: 12px 20px;
  flex: 1;
  min-width: 320px;
  border: 2px solid #e2e8f0;
  transition: all 0.3s ease;
}

.search-box:focus-within {
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.search-box i {
  color: #64748b;
  margin-right: 12px;
  font-size: 1.1rem;
}

.search-box input {
  border: none;
  background: none;
  outline: none;
  flex: 1;
  padding: 8px 0;
  font-size: 1rem;
  color: #1e293b;
}

.search-btn {
  background: var(--primary-gradient);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 10px;
  cursor: pointer;
  margin-left: 16px;
  font-weight: 600;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.filter-controls {
  display: flex;
  gap: 16px;
  align-items: center;
  flex-wrap: wrap;
}

.filter-select {
  padding: 12px 20px;
  border: 2px solid #e2e8f0;
  border-radius: 10px;
  background: white;
  color: #475569;
  min-width: 180px;
  font-size: 1rem;
  transition: all 0.3s ease;
  cursor: pointer;
}

.clear-filters {
  background: #f1f5f9;
  border: 2px solid #e2e8f0;
  color: #64748b;
  padding: 12px 20px;
  border-radius: 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: all 0.3s ease;
  font-weight: 500;
}

/* ===== TH·ªêNG K√ä ===== */
.stats-overview {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 24px;
  margin-bottom: 32px;
}

.stat-card {
  background: white;
  border-radius: var(--border-radius-xl);
  padding: 32px;
  display: flex;
  align-items: center;
  gap: 20px;
  box-shadow: var(--shadow-light);
  transition: all 0.3s ease;
  border: 1px solid rgba(0, 0, 0, 0.03);
  position: relative;
  overflow: hidden;
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: var(--primary-gradient);
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-medium);
}

.stat-icon {
  width: 80px;
  height: 80px;
  border-radius: var(--border-radius-xl);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2rem;
  box-shadow: var(--shadow-light);
}

.stat-icon.total { background: linear-gradient(135deg, #fed7d7, #feb2b2); color: #c53030; }
.stat-icon.active { background: linear-gradient(135deg, #c6f6d5, #9ae6b4); color: #276749; }
.stat-icon.reception { background: linear-gradient(135deg, #fed7d7, #feb2b2); color: #c53030; }
.stat-icon.service { background: linear-gradient(135deg, #fefcbf, #faf089); color: #d69e2e; }
.stat-icon.technical { background: linear-gradient(135deg, #e9d8fd, #d6bcfa); color: #6b46c1; }
.stat-icon.manager { background: linear-gradient(135deg, #c6f6d5, #9ae6b4); color: #276749; }
.stat-icon.security { background: linear-gradient(135deg, #fed7d7, #feb2b2); color: #c53030; }
.stat-icon.fulltime { background: linear-gradient(135deg, #bee3f8, #90cdf4); color: #2c5aa0; }

.stat-info h3 {
  margin: 0;
  font-size: 2.5rem;
  color: #1e293b;
  font-weight: 700;
}

.stat-info p {
  margin: 8px 0 0 0;
  color: #64748b;
  font-size: 1.1rem;
  font-weight: 500;
}

/* ===== L∆Ø·ªöI H√ìA ƒê∆†N ===== */
.employees-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
  gap: 28px;
}

.employee-card {
  background: white;
  border-radius: var(--border-radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-light);
  transition: all 0.4s ease;
  border: 1px solid rgba(0, 0, 0, 0.03);
  position: relative;
}

.employee-card:hover {
  transform: translateY(-8px);
  box-shadow: var(--shadow-heavy);
}

.employee-image {
  position: relative;
  height: 240px;
  overflow: hidden;
}

.employee-avatar-placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
}

.employee-avatar-placeholder.bill {
  background: var(--primary-gradient);
}

.employee-avatar-placeholder.bill i {
  font-size: 2rem;
}

.employee-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.9), rgba(118, 75, 162, 0.9));
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: all 0.4s ease;
}

.employee-card:hover .employee-overlay {
  opacity: 1;
}

.employee-actions {
  display: flex;
  gap: 16px;
}

.btn-edit,
.btn-delete {
  width: 56px;
  height: 56px;
  border: none;
  border-radius: 14px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.btn-edit {
  background: var(--success-gradient);
  color: white;
}

.btn-delete {
  background: var(--danger-gradient);
  color: white;
}

.employee-badge {
  position: absolute;
  top: 16px;
  left: 16px;
  padding: 8px 16px;
  border-radius: 25px;
  font-size: 0.85rem;
  font-weight: 700;
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow-light);
  z-index: 2;
}

.employee-badge.Ch∆∞a\ thanh\ to√°n {
  background: linear-gradient(135deg, rgba(237, 137, 54, 0.95), rgba(217, 119, 6, 0.95));
  color: white;
}

.employee-badge.ƒê√£\ thanh\ to√°n {
  background: linear-gradient(135deg, rgba(72, 187, 120, 0.95), rgba(56, 161, 105, 0.95));
  color: white;
}

.employee-badge.ƒê√£\ h·ªßy {
  background: linear-gradient(135deg, rgba(245, 101, 101, 0.95), rgba(229, 62, 62, 0.95));
  color: white;
}

.employee-status {
  position: absolute;
  bottom: 16px;
  right: 16px;
  padding: 8px 16px;
  border-radius: 25px;
  font-size: 0.9rem;
  font-weight: 700;
  box-shadow: var(--shadow-light);
  z-index: 2;
}

.employee-status.active {
  background: linear-gradient(135deg, rgba(72, 187, 120, 0.95), rgba(56, 161, 105, 0.95));
  color: white;
}

.employee-status.onleave {
  background: linear-gradient(135deg, rgba(237, 137, 54, 0.95), rgba(217, 119, 6, 0.95));
  color: white;
}

.employee-status.inactive {
  background: linear-gradient(135deg, rgba(245, 101, 101, 0.95), rgba(229, 62, 62, 0.95));
  color: white;
}

.employee-content {
  padding: 24px;
}

.employee-name {
  margin: 0 0 12px 0;
  color: #1e293b;
  font-size: 1.4rem;
  font-weight: 700;
}

.employee-code {
  margin: 0 0 20px 0;
  color: #64748b;
  font-size: 1rem;
  font-weight: 500;
}

.employee-details {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 20px;
}

.detail-item {
  display: flex;
  align-items: center;
  gap: 12px;
  color: #475569;
  font-size: 1rem;
}

.detail-item i {
  color: #667eea;
  width: 20px;
  font-size: 1.1rem;
}

/* ===== CHI TI·∫æT D·ªäCH V·ª§ TRONG CARD ===== */
.service-breakdown {
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid #e2e8f0;
}

.service-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 5px;
  font-size: 0.9em;
}

.service-name {
  flex: 1;
}

.service-quantity {
  margin: 0 10px;
  color: #666;
}

.service-price {
  font-weight: bold;
  color: #2d3748;
}

/* ===== FOOTER CARD V·ªöI N√öT ===== */
.employee-footer {
  display: flex;
  gap: 10px;
  margin-top: 20px;
  padding-top: 15px;
  border-top: 1px solid #e2e8f0;
}

.employee-footer button {
  flex: 1;
  padding: 10px 15px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-weight: 600;
  font-size: 0.9rem;
  transition: all 0.3s ease;
}

.btn-detail {
  background: var(--info-gradient);
  color: white;
}

.btn-detail:hover {
  background: linear-gradient(135deg, #3182ce, #2c5aa0);
  transform: translateY(-2px);
}

.btn-pay {
  background: var(--success-gradient);
  color: white;
}

.btn-pay:hover {
  background: linear-gradient(135deg, #38a169, #2f855a);
  transform: translateY(-2px);
}

.btn-print {
  background: var(--warning-gradient);
  color: white;
}

.btn-print:hover {
  background: linear-gradient(135deg, #dd6b20, #c05621);
  transform: translateY(-2px);
}

/* ===== TR·∫†NG TH√ÅI R·ªñNG ===== */
.empty-state {
  text-align: center;
  padding: 80px 40px;
  background: white;
  border-radius: var(--border-radius-xl);
  box-shadow: var(--shadow-light);
  border: 2px dashed #e2e8f0;
}

.empty-icon {
  font-size: 5rem;
  margin-bottom: 24px;
  opacity: 0.7;
}

.empty-state h3 {
  margin: 0 0 12px 0;
  color: #1e293b;
  font-size: 1.8rem;
  font-weight: 700;
}

.empty-state p {
  margin: 0 0 32px 0;
  color: #64748b;
  font-size: 1.2rem;
}

/* ===== MODAL CHUNG ===== */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  padding: 20px;
  backdrop-filter: blur(8px);
}

.modal-container {
  background: white;
  border-radius: var(--border-radius-xl);
  width: 100%;
  max-width: 600px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
  border: 1px solid rgba(255, 255, 255, 0.2);
  animation: modalSlideIn 0.4s ease-out;
}

.modal-container.large {
  max-width: 800px;
}

.invoice-modal {
  max-width: 800px;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: translateY(-30px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 28px;
  border-bottom: 2px solid #f1f5f9;
  background: linear-gradient(135deg, #f8fafc, #f1f5f9);
  border-radius: var(--border-radius-xl) var(--border-radius-xl) 0 0;
}

.modal-header h2 {
  margin: 0;
  color: #1e293b;
  font-size: 1.8rem;
  font-weight: 700;
}

.modal-close {
  background: #f1f5f9;
  border: none;
  font-size: 1.4rem;
  color: #64748b;
  cursor: pointer;
  padding: 8px;
  border-radius: var(--border-radius);
  transition: all 0.3s ease;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-body {
  padding: 28px;
}

.modal-footer {
  display: flex;
  justify-content: flex-end;
  gap: 16px;
  padding: 28px;
  border-top: 2px solid #f1f5f9;
  background: #f8fafc;
  border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
}

/* ===== FORM TRONG MODAL ===== */
.form-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 20px;
}

.form-group {
  display: flex;
  flex-direction: column;
}

.form-group.full-width {
  grid-column: 1 / -1;
}

.form-group label {
  margin-bottom: 10px;
  color: #374151;
  font-weight: 600;
  font-size: 1rem;
}

.form-group input,
.form-group select,
.form-group textarea {
  padding: 14px 16px;
  border: 2px solid #e2e8f0;
  border-radius: var(--border-radius);
  font-size: 1rem;
  transition: all 0.3s ease;
  background: white;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  transform: translateY(-1px);
}

/* ===== PH·∫¶N D·ªäCH V·ª§ TRONG MODAL ===== */
.services-section {
  margin: 20px 0;
  padding: 20px;
  background: #f7fafc;
  border-radius: 8px;
}

.service-controls {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.service-controls select,
.service-controls input {
  flex: 1;
}

.services-list {
  max-height: 200px;
  overflow-y: auto;
}

.service-item-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px;
  background: white;
  margin-bottom: 5px;
  border-radius: 4px;
  border: 1px solid #e2e8f0;
}

.service-info {
  flex: 1;
}

.service-details {
  font-size: 0.8em;
  color: #718096;
  display: block;
}

.service-actions {
  display: flex;
  align-items: center;
  gap: 10px;
}

/* ===== T·ªîNG TI·ªÄN TRONG MODAL ===== */
.total-section {
  margin-top: 20px;
  padding: 15px;
  background: #edf2f7;
  border-radius: 8px;
}

.total-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
}

.grand-total {
  border-top: 2px solid #cbd5e0;
  padding-top: 8px;
  margin-top: 8px;
  font-size: 1.1em;
}

/* ===== HEADER MODAL H√ìA ƒê∆†N HI·ªÜN ƒê·∫†I ===== */
.modal-header.invoice-company-header {
  background: var(--primary-gradient);
  color: white;
  padding: 25px 30px 20px;
  border-radius: var(--border-radius-xl) var(--border-radius-xl) 0 0;
  display: block;
}

/* H√†ng 1: Logo v√† n√∫t h√†nh ƒë·ªông */
.header-top-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.company-logo {
  display: flex;
  align-items: center;
  gap: 15px;
}

.logo-placeholder {
  width: 50px;
  height: 50px;
  background: rgba(255,255,255,0.2);
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
}

.company-info h1 {
  margin: 0 0 5px 0;
  font-size: 22px;
  font-weight: 700;
  line-height: 1.2;
}

.company-info p {
  margin: 0;
  font-size: 13px;
  opacity: 0.9;
  line-height: 1.3;
}

.header-actions {
  display: flex;
  gap: 10px;
  align-items: center;
}

.btn-print-invoice,
.btn-download-invoice,
.btn-pay-invoice {
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.3s ease;
  background: rgba(255,255,255,0.2);
  color: white;
  backdrop-filter: blur(10px);
}

.btn-print-invoice:hover,
.btn-download-invoice:hover,
.btn-pay-invoice:hover {
  background: rgba(255,255,255,0.3);
  transform: translateY(-2px);
}

.btn-pay-invoice {
  background: var(--success-gradient);
}

.modal-close {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  font-size: 16px;
}

.modal-close:hover {
  background: rgba(255,255,255,0.3);
  transform: rotate(90deg);
}

/* H√†ng 2: Ti√™u ƒë·ªÅ */
.header-title-row {
  text-align: center;
  margin: 40px 0px 15px 0px;
}

.header-title-row h2 {
  margin: 0;
  font-size: 34px;
  font-weight: 700;
  color: white;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* H√†ng 3: Th√¥ng tin h√≥a ƒë∆°n */
.header-meta-row {
  display: flex;
  justify-content: center;
  gap: 30px;
  flex-wrap: wrap;
}

.meta-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.meta-item .label {
  font-size: 13px;
  opacity: 0.8;
  margin-bottom: 4px;
  font-weight: 500;
}

.meta-item .value {
  font-size: 16px;
  font-weight: 600;
}

.status-badge {
  padding: 3px 6px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 600;
}

.status-badge.paid {
  background: rgba(72, 187, 120, 0.9);
  color: white;
}

.status-badge.pending {
  background: rgba(237, 137, 54, 0.9);
  color: white;
}

.status-badge.cancelled {
  background: rgba(245, 101, 101, 0.9);
  color: white;
}

/* ===== H√ìA ƒê∆†N CHI TI·∫æT HI·ªÜN ƒê·∫†I ===== */
.modern-invoice {
  background: white;
  border-radius: 0 0 12px 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  overflow: hidden;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.invoice-customer-info {
  padding: 25px 30px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  border-bottom: 1px solid #e2e8f0;
}

.info-section h3 {
  margin: 0 0 15px 0;
  color: #2d3748;
  font-size: 16px;
  font-weight: 600;
}

.info-grid {
  display: grid;
  gap: 10px;
}

.info-item {
  display: flex;
  justify-content: space-between;
}

.info-item .label {
  color: #718096;
  font-weight: 500;
}

.info-item .value {
  color: #2d3748;
  font-weight: 600;
}

.invoice-services {
  padding: 25px 30px;
  border-bottom: 1px solid #e2e8f0;
}

.invoice-services h3 {
  margin: 0 0 20px 0;
  color: #2d3748;
  font-size: 18px;
  font-weight: 600;
}

.services-table {
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  overflow: hidden;
}

.table-header {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr;
  background: #f7fafc;
  padding: 15px 20px;
  font-weight: 600;
  color: #4a5568;
  border-bottom: 1px solid #e2e8f0;
}

.table-row {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr;
  padding: 15px 20px;
  border-bottom: 1px solid #e2e8f0;
}

.table-row:last-child {
  border-bottom: none;
}

.table-row.no-services {
  grid-template-columns: 1fr;
  text-align: center;
  color: #718096;
  font-style: italic;
}

.col-service .service-name {
  display: block;
  font-weight: 500;
  color: #2d3748;
}

.col-service .service-desc {
  display: block;
  font-size: 12px;
  color: #718096;
  margin-top: 4px;
}

.col-quantity, .col-price, .col-total {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  font-weight: 500;
}

.invoice-summary {
  padding: 25px 30px;
  border-bottom: 1px solid #e2e8f0;
}

.summary-row {
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
}

.summary-row.total {
  border-top: 2px solid #e2e8f0;
  margin-top: 10px;
  padding-top: 15px;
  font-size: 18px;
  font-weight: 700;
  color: #2d3748;
}

.invoice-payment {
  padding: 25px 30px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  border-bottom: 1px solid #e2e8f0;
}

.payment-method h4, .payment-notes h4 {
  margin: 0 0 15px 0;
  color: #2d3748;
  font-size: 16px;
  font-weight: 600;
}

.method {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 15px;
  background: #f7fafc;
  border-radius: 8px;
  font-weight: 500;
}

.method.paid {
  color: #48bb78;
}

.method.cash {
  color: #ed8936;
}

.payment-notes p {
  margin: 5px 0;
  color: #718096;
  font-size: 14px;
}

.invoice-footer {
  padding: 25px 30px;
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
}

.footer-signature {
  text-align: center;
}

.signature-line {
  width: 200px;
  height: 1px;
  background: #2d3748;
  margin-bottom: 5px;
}

.footer-signature p {
  margin: 0;
  color: #718096;
  font-size: 14px;
}

.footer-thanks {
  text-align: right;
}

.footer-thanks p {
  margin: 2px 0;
  color: #4a5568;
}

/* ===== TR·∫†NG TH√ÅI LOADING V√Ä ERROR ===== */
.loading-invoice {
  text-align: center;
  padding: 60px 20px;
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #667eea;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.error-state {
  text-align: center;
  padding: 60px 20px;
}

.error-icon {
  font-size: 48px;
  margin-bottom: 20px;
}

.error-state h3 {
  margin: 0 0 10px 0;
  color: #2d3748;
}

.error-state p {
  margin: 0 0 20px 0;
  color: #718096;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .main-content {
    margin-left: 0 !important;
    padding: 16px;
  }

  .admin-dashboard {
    padding: 16px;
  }

  .header-content {
    flex-direction: column;
    align-items: stretch;
    text-align: center;
  }

  .header-title {
    justify-content: center;
    text-align: center;
  }

  .search-filter-bar {
    flex-direction: column;
    align-items: stretch;
    padding: 20px;
  }

  .search-box {
    min-width: auto;
    margin-bottom: 16px;
  }

  .filter-controls {
    flex-direction: column;
    align-items: stretch;
  }

  .filter-select {
    min-width: auto;
  }

  .form-grid {
    grid-template-columns: 1fr;
  }

  .employees-grid {
    grid-template-columns: 1fr;
    gap: 20px;
  }

  .stats-overview {
    grid-template-columns: 1fr;
    gap: 20px;
  }

  .modal-container {
    margin: 10px;
    max-width: none;
  }

  .employee-footer {
    flex-direction: column;
  }

  .invoice-customer-info,
  .invoice-payment {
    grid-template-columns: 1fr;
    gap: 20px;
  }

  .table-header,
  .table-row {
    grid-template-columns: 1fr;
    text-align: center;
    gap: 10px;
  }

  .col-quantity, .col-price, .col-total {
    justify-content: center;
  }

  .invoice-footer {
    flex-direction: column;
    gap: 20px;
    align-items: center;
  }

  .footer-signature,
  .footer-thanks {
    text-align: center;
  }

  /* Responsive cho header modal h√≥a ƒë∆°n */
  .modal-header.invoice-company-header {
    padding: 20px 15px 15px;
  }

  .header-top-row {
    flex-direction: column;
    gap: 15px;
    margin-bottom: 15px;
  }

  .company-logo {
    flex-direction: column;
    text-align: center;
    gap: 10px;
  }

  .company-info h1 {
    font-size: 20px;
  }

  .company-info p {
    font-size: 12px;
  }

  .header-actions {
    width: 100%;
    justify-content: center;
  }

  .header-title-row h2 {
    font-size: 20px;
  }

  .header-meta-row {
    gap: 15px;
  }

  .meta-item .label {
    font-size: 12px;
  }

  .meta-item .value {
    font-size: 14px;
  }

  .btn-print-invoice,
  .btn-download-invoice,
  .btn-pay-invoice {
    padding: 8px 12px;
    font-size: 12px;
  }
}

@media (max-width: 480px) {
  .header-meta-row {
    flex-direction: column;
    gap: 10px;
  }
  
  .meta-item {
    flex-direction: row;
    justify-content: space-between;
    width: 100%;
  }
  
  .meta-item .label {
    margin-bottom: 0;
  }
}

/* ===== CSS CHO IN ·∫§N H√ìA ƒê∆†N ===== */
@media print {
  body { 
    margin: 0; 
    padding: 20px; 
    background: white !important;
  }
  
  .modern-invoice { 
    box-shadow: none; 
    border: 1px solid #ddd;
    padding: 20px;
    margin: 0;
  }
  
  .btn-print-invoice, 
  .btn-download-invoice, 
  .btn-pay-invoice,
  .modal-close,
  .modal-header .invoice-actions { 
    display: none !important; 
  }
  
  .modal-overlay {
    position: static;
    background: none;
    backdrop-filter: none;
  }
  
  .modal-container {
    box-shadow: none;
    max-width: none;
    max-height: none;
  }
}
</style>